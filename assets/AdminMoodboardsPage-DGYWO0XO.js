import{r as c,b as Y,j as e,B as r,L as j,X as Z,l as N}from"./index-D3NDjr5B.js";import{A as _}from"./AdminHeader-BAyozb3y.js";import{I as ee}from"./input-BdVIbqQ3.js";import{C,d as S}from"./card-BFk44DtX.js";import{B}from"./badge-BNXinaOz.js";import{C as I}from"./checkbox-v75AHoIs.js";import{D as se,a as te,b as ae,c as w,f as ie}from"./dropdown-menu-DdC2iEtp.js";import{m as le}from"./moodboards.api-C7eEO7WO.js";import{b as g}from"./admin.api-JLzlyybJ.js";import{S as re}from"./SEO-BaS7uEy3.js";import{P as T}from"./plus-CiqXQg95.js";import{S as ne}from"./search-B-Nupm7w.js";import{E as y}from"./eye-DnRMw2Xi.js";import{E as k,S as U}from"./square-pen-CNJ5w3Zp.js";import{T as V}from"./trash-2-C4pTXx8A.js";import{E as ce}from"./ellipsis-vertical-BTA3OLDq.js";import"./house-DV4jgYEM.js";import"./index-C8hAjUGN.js";function Me(){const[m,x]=c.useState([]),[P,M]=c.useState(!0),[o,H]=c.useState(""),[i,u]=c.useState(new Set),[p,f]=c.useState(!1),{toast:l}=Y(),[h,$]=c.useState(1),[O,oe]=c.useState(12),[v,Q]=c.useState({totalPages:1,totalCount:0});c.useEffect(()=>{q()},[h,o]);const q=async()=>{try{M(!0);const s=await le.getAllMoodboards({page:h,limit:O,search:o});x(s.data),Q(s.pagination)}catch{l({title:"Error",description:"Failed to load moodboards",variant:"destructive"})}finally{M(!1)}},R=async(s,t)=>{if(confirm(`Are you sure you want to delete "${t}"?`))try{await g.deleteMoodboard(s),x(m.filter(a=>a.id!==s)),l({title:"Success",description:"Moodboard deleted successfully"})}catch{l({title:"Error",description:"Failed to delete moodboard",variant:"destructive"})}},X=async(s,t)=>{try{const a=await g.publishMoodboard(s,!t);x(m.map(d=>d.id===s?{...d,isPublished:a.isPublished}:d)),l({title:"Success",description:`Moodboard ${t?"unpublished":"published"}`})}catch{l({title:"Error",description:"Failed to update moodboard status",variant:"destructive"})}},A=()=>{i.size===n.length?u(new Set):u(new Set(n.map(s=>s.id)))},G=s=>{const t=new Set(i);t.has(s)?t.delete(s):t.add(s),u(t)},J=async()=>{const s=i.size;if(confirm(`Are you sure you want to delete ${s} selected moodboard${s>1?"s":""}?`))try{f(!0);const t=await g.bulkDelete(Array.from(i));x(m.filter(a=>!t.success.includes(a.id))),u(new Set),t.failedCount>0?l({title:"Partial Success",description:`${t.successCount} deleted, ${t.failedCount} failed`,variant:"default"}):l({title:"Success",description:`${s} moodboard${s>1?"s":""} deleted successfully`})}catch{l({title:"Error",description:"Failed to delete moodboards",variant:"destructive"})}finally{f(!1)}},K=async()=>{const s=i.size;try{f(!0);const t=await g.bulkPublish(Array.from(i),!0);x(m.map(a=>t.success.includes(a.id)?{...a,isPublished:!0}:a)),u(new Set),t.failedCount>0?l({title:"Partial Success",description:`${t.successCount} published, ${t.failedCount} failed`,variant:"default"}):l({title:"Success",description:`${s} moodboard${s>1?"s":""} published successfully`})}catch{l({title:"Error",description:"Failed to publish moodboards",variant:"destructive"})}finally{f(!1)}},W=async()=>{const s=i.size;try{f(!0);const t=await g.bulkPublish(Array.from(i),!1);x(m.map(a=>t.success.includes(a.id)?{...a,isPublished:!1}:a)),u(new Set),t.failedCount>0?l({title:"Partial Success",description:`${t.successCount} unpublished, ${t.failedCount} failed`,variant:"default"}):l({title:"Success",description:`${s} moodboard${s>1?"s":""} unpublished successfully`})}catch{l({title:"Error",description:"Failed to unpublish moodboards",variant:"destructive"})}finally{f(!1)}},n=m.filter(s=>{var t,a;return s.title.toLowerCase().includes(o.toLowerCase())||((t=s.description)==null?void 0:t.toLowerCase().includes(o.toLowerCase()))||((a=s.tags)==null?void 0:a.some(d=>d.toLowerCase().includes(o.toLowerCase())))}),E=n.length>0&&i.size===n.length,z=i.size>0&&i.size<n.length;return e.jsxs(e.Fragment,{children:[e.jsx(re,{title:"Manage Moodboards - Admin",description:"Manage moodboard collections"}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(_,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-serif text-3xl font-bold mb-2",children:"Moodboards"}),e.jsxs("p",{className:"text-muted-foreground",children:[n.length," of ",m.length," moodboards"]})]}),e.jsx(r,{asChild:!0,children:e.jsxs(j,{to:"/admin/moodboards/new",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Add Moodboard"]})})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(ee,{placeholder:"Search moodboards by title, description, or tags...",value:o,onChange:s=>H(s.target.value),className:"pl-10"})]}),i.size>0&&e.jsx(C,{className:"mb-6 border-primary/50 bg-primary/5",children:e.jsx(S,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(B,{variant:"secondary",className:"text-sm font-medium",children:[i.size," selected"]}),e.jsxs(r,{variant:"ghost",size:"sm",onClick:()=>u(new Set),className:"h-8",children:[e.jsx(Z,{className:"w-4 h-4 mr-1"}),"Clear"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:K,disabled:p,className:"h-8",children:[p?e.jsx(N,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(y,{className:"w-4 h-4 mr-1"}),"Publish All"]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:W,disabled:p,className:"h-8",children:[p?e.jsx(N,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(k,{className:"w-4 h-4 mr-1"}),"Unpublish All"]}),e.jsxs(r,{variant:"destructive",size:"sm",onClick:J,disabled:p,className:"h-8",children:[p?e.jsx(N,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(V,{className:"w-4 h-4 mr-1"}),"Delete All"]})]})]})})}),!P&&n.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(I,{checked:E,onCheckedChange:A,className:z?"data-[state=checked]:bg-primary/50":""}),e.jsxs("label",{className:"text-sm font-medium cursor-pointer select-none",onClick:A,children:[E?"Deselect all":"Select all",z&&` (${i.size} selected)`]})]}),P?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(N,{className:"w-8 h-8 animate-spin text-primary"})}):n.length===0?e.jsx(C,{children:e.jsxs(S,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:o?"No moodboards found matching your search":"No moodboards yet"}),!o&&e.jsx(r,{asChild:!0,children:e.jsxs(j,{to:"/admin/moodboards/new",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Create First Moodboard"]})})]})}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:n.map(s=>{var t,a,d,L,D,F;return e.jsxs(C,{className:"overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx(I,{checked:i.has(s.id),onCheckedChange:()=>G(s.id),className:"bg-background border-2 shadow-sm"})}),e.jsxs("div",{className:"aspect-[4/3] bg-muted relative group",children:[e.jsx("img",{src:s.coverImage,alt:s.title,className:"w-full h-full object-cover",onError:b=>{b.currentTarget.src="https://images.unsplash.com/photo-1490481651871-ab68de25d43d"}}),e.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[e.jsx(r,{size:"sm",variant:"secondary",asChild:!0,children:e.jsxs(j,{to:`/admin/moodboards/edit/${s.id}`,children:[e.jsx(U,{className:"w-4 h-4 mr-1"}),"Edit"]})}),e.jsx(r,{size:"sm",variant:"secondary",asChild:!0,children:e.jsxs(j,{to:`/moodboards/${s.slug}`,children:[e.jsx(y,{className:"w-4 h-4 mr-1"}),"View"]})})]})]}),e.jsxs(S,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium truncate",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description})]}),e.jsxs(se,{children:[e.jsx(te,{asChild:!0,children:e.jsx(r,{variant:"ghost",size:"icon",className:"shrink-0",children:e.jsx(ce,{className:"w-4 h-4"})})}),e.jsxs(ae,{align:"end",children:[e.jsx(w,{asChild:!0,children:e.jsxs(j,{to:`/admin/moodboards/edit/${s.id}`,children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Edit"]})}),e.jsx(w,{asChild:!0,children:e.jsxs(j,{to:`/moodboards/${s.slug}`,children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"View on Site"]})}),e.jsx(w,{onClick:()=>X(s.id,!!s.isPublished),children:s.isPublished?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Unpublish"]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Publish"]})}),e.jsx(ie,{}),e.jsxs(w,{onClick:()=>R(s.id,s.title),className:"text-destructive",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((t=s.products)==null?void 0:t.length)||0," products"]}),s.isFeatured&&e.jsx(B,{variant:"secondary",className:"text-xs",children:"Featured"}),s.isPublished===!1&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-yellow-100 text-yellow-800 rounded-lg mb-4 text-sm font-medium w-fit",children:[e.jsx(k,{className:"h-4 w-4"}),"UNPUBLISHED"]})]}),s.tags&&((a=s.tags)==null?void 0:a.length)>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[(L=(d=s.tags)==null?void 0:d.slice(0,3))==null?void 0:L.map(b=>e.jsx("span",{className:"inline-block px-2 py-0.5 bg-muted text-xs rounded",children:b},b)),(((D=s.tags)==null?void 0:D.length)||0)>3&&e.jsxs("span",{className:"inline-block px-2 py-0.5 text-xs text-muted-foreground",children:["+",(((F=s.tags)==null?void 0:F.length)||0)-3]})]})]})]},s.id)})}),v.totalPages>1&&e.jsxs("div",{className:"flex justify-center items-center gap-4 mt-8",children:[e.jsx(r,{variant:"outline",disabled:h===1,onClick:()=>$(h-1),children:"Previous"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",h," of ",v.totalPages]}),e.jsx(r,{variant:"outline",disabled:h===v.totalPages,onClick:()=>$(h+1),children:"Next"})]})]})]})]})}export{Me as default};
