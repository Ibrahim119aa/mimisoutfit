import{r as p,d as X,j as e,B as c,L as f,X as G,l as g}from"./index-fZ_4v1pA.js";import{A as J}from"./AdminHeader-pBLznoy7.js";import{I as K}from"./input-BKC103na.js";import{C as y,d as v}from"./card-B3KlpYA-.js";import{B as D}from"./badge-D-0GamXg.js";import{C as L}from"./checkbox-rxtmnzuM.js";import{D as W,a as Y,b as Z,c as w,f as _}from"./dropdown-menu-Mh0D0jpL.js";import{m as ee}from"./moodboards.api-CSZKZZYZ.js";import{b as j}from"./admin.api-C7JOjN0i.js";import{S as se}from"./SEO-CJ6FqJ39.js";import{P as F}from"./plus-YKCG0mRQ.js";import{S as te}from"./search-ewGgIG-S.js";import{E as N}from"./eye-CL2tiTt8.js";import{E as C,S as B}from"./square-pen-CyekwJGC.js";import{T as I}from"./trash-2-BR3xMuc0.js";import{E as ae}from"./ellipsis-vertical-Byijx4pO.js";import"./house-BCGUpAir.js";import"./index-Gc2GZ3r9.js";function ye(){const[d,m]=p.useState([]),[S,k]=p.useState(!0),[u,T]=p.useState(""),[i,o]=p.useState(new Set),[h,x]=p.useState(!1),{toast:l}=X();p.useEffect(()=>{U()},[]);const U=async()=>{try{k(!0);const s=await ee.getAllMoodboards({limit:1e3});m(s.data)}catch{l({title:"Error",description:"Failed to load moodboards",variant:"destructive"})}finally{k(!1)}},V=async(s,t)=>{if(confirm(`Are you sure you want to delete "${t}"?`))try{await j.deleteMoodboard(s),m(d.filter(a=>a.id!==s)),l({title:"Success",description:"Moodboard deleted successfully"})}catch{l({title:"Error",description:"Failed to delete moodboard",variant:"destructive"})}},H=async(s,t)=>{try{const a=await j.publishMoodboard(s,!t);m(d.map(n=>n.id===s?{...n,isPublished:a.isPublished}:n)),l({title:"Success",description:`Moodboard ${t?"unpublished":"published"}`})}catch{l({title:"Error",description:"Failed to update moodboard status",variant:"destructive"})}},M=()=>{i.size===r.length?o(new Set):o(new Set(r.map(s=>s.id)))},O=s=>{const t=new Set(i);t.has(s)?t.delete(s):t.add(s),o(t)},Q=async()=>{const s=i.size;if(confirm(`Are you sure you want to delete ${s} selected moodboard${s>1?"s":""}?`))try{x(!0);const t=await j.bulkDelete(Array.from(i));m(d.filter(a=>!t.success.includes(a.id))),o(new Set),t.failedCount>0?l({title:"Partial Success",description:`${t.successCount} deleted, ${t.failedCount} failed`,variant:"default"}):l({title:"Success",description:`${s} moodboard${s>1?"s":""} deleted successfully`})}catch{l({title:"Error",description:"Failed to delete moodboards",variant:"destructive"})}finally{x(!1)}},q=async()=>{const s=i.size;try{x(!0);const t=await j.bulkPublish(Array.from(i),!0);m(d.map(a=>t.success.includes(a.id)?{...a,isPublished:!0}:a)),o(new Set),t.failedCount>0?l({title:"Partial Success",description:`${t.successCount} published, ${t.failedCount} failed`,variant:"default"}):l({title:"Success",description:`${s} moodboard${s>1?"s":""} published successfully`})}catch{l({title:"Error",description:"Failed to publish moodboards",variant:"destructive"})}finally{x(!1)}},R=async()=>{const s=i.size;try{x(!0);const t=await j.bulkPublish(Array.from(i),!1);m(d.map(a=>t.success.includes(a.id)?{...a,isPublished:!1}:a)),o(new Set),t.failedCount>0?l({title:"Partial Success",description:`${t.successCount} unpublished, ${t.failedCount} failed`,variant:"default"}):l({title:"Success",description:`${s} moodboard${s>1?"s":""} unpublished successfully`})}catch{l({title:"Error",description:"Failed to unpublish moodboards",variant:"destructive"})}finally{x(!1)}},r=d.filter(s=>{var t,a;return s.title.toLowerCase().includes(u.toLowerCase())||((t=s.description)==null?void 0:t.toLowerCase().includes(u.toLowerCase()))||((a=s.tags)==null?void 0:a.some(n=>n.toLowerCase().includes(u.toLowerCase())))}),P=r.length>0&&i.size===r.length,$=i.size>0&&i.size<r.length;return e.jsxs(e.Fragment,{children:[e.jsx(se,{title:"Manage Moodboards - Admin",description:"Manage moodboard collections"}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(J,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-serif text-3xl font-bold mb-2",children:"Moodboards"}),e.jsxs("p",{className:"text-muted-foreground",children:[r.length," of ",d.length," moodboards"]})]}),e.jsx(c,{asChild:!0,children:e.jsxs(f,{to:"/admin/moodboards/new",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Add Moodboard"]})})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(te,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(K,{placeholder:"Search moodboards by title, description, or tags...",value:u,onChange:s=>T(s.target.value),className:"pl-10"})]}),i.size>0&&e.jsx(y,{className:"mb-6 border-primary/50 bg-primary/5",children:e.jsx(v,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(D,{variant:"secondary",className:"text-sm font-medium",children:[i.size," selected"]}),e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>o(new Set),className:"h-8",children:[e.jsx(G,{className:"w-4 h-4 mr-1"}),"Clear"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:q,disabled:h,className:"h-8",children:[h?e.jsx(g,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(N,{className:"w-4 h-4 mr-1"}),"Publish All"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:R,disabled:h,className:"h-8",children:[h?e.jsx(g,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(C,{className:"w-4 h-4 mr-1"}),"Unpublish All"]}),e.jsxs(c,{variant:"destructive",size:"sm",onClick:Q,disabled:h,className:"h-8",children:[h?e.jsx(g,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(I,{className:"w-4 h-4 mr-1"}),"Delete All"]})]})]})})}),!S&&r.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(L,{checked:P,onCheckedChange:M,className:$?"data-[state=checked]:bg-primary/50":""}),e.jsxs("label",{className:"text-sm font-medium cursor-pointer select-none",onClick:M,children:[P?"Deselect all":"Select all",$&&` (${i.size} selected)`]})]}),S?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(g,{className:"w-8 h-8 animate-spin text-primary"})}):r.length===0?e.jsx(y,{children:e.jsxs(v,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:u?"No moodboards found matching your search":"No moodboards yet"}),!u&&e.jsx(c,{asChild:!0,children:e.jsxs(f,{to:"/admin/moodboards/new",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Create First Moodboard"]})})]})}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:r.map(s=>{var t,a,n,A,E,z;return e.jsxs(y,{className:"overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx(L,{checked:i.has(s.id),onCheckedChange:()=>O(s.id),className:"bg-background border-2 shadow-sm"})}),e.jsxs("div",{className:"aspect-[4/3] bg-muted relative group",children:[e.jsx("img",{src:s.coverImage,alt:s.title,className:"w-full h-full object-cover",onError:b=>{b.currentTarget.src="https://images.unsplash.com/photo-1490481651871-ab68de25d43d"}}),e.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[e.jsx(c,{size:"sm",variant:"secondary",asChild:!0,children:e.jsxs(f,{to:`/admin/moodboards/edit/${s.id}`,children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),"Edit"]})}),e.jsx(c,{size:"sm",variant:"secondary",asChild:!0,children:e.jsxs(f,{to:`/moodboards/${s.slug}`,children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"View"]})})]})]}),e.jsxs(v,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium truncate",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description})]}),e.jsxs(W,{children:[e.jsx(Y,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",className:"shrink-0",children:e.jsx(ae,{className:"w-4 h-4"})})}),e.jsxs(Z,{align:"end",children:[e.jsx(w,{asChild:!0,children:e.jsxs(f,{to:`/admin/moodboards/edit/${s.id}`,children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Edit"]})}),e.jsx(w,{asChild:!0,children:e.jsxs(f,{to:`/moodboards/${s.slug}`,children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"View on Site"]})}),e.jsx(w,{onClick:()=>H(s.id,!!s.isPublished),children:s.isPublished?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Unpublish"]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Publish"]})}),e.jsx(_,{}),e.jsxs(w,{onClick:()=>V(s.id,s.title),className:"text-destructive",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((t=s.products)==null?void 0:t.length)||0," products"]}),s.isFeatured&&e.jsx(D,{variant:"secondary",className:"text-xs",children:"Featured"}),s.isPublished===!1&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-yellow-100 text-yellow-800 rounded-lg mb-4 text-sm font-medium w-fit",children:[e.jsx(C,{className:"h-4 w-4"}),"UNPUBLISHED"]})]}),s.tags&&((a=s.tags)==null?void 0:a.length)>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[(A=(n=s.tags)==null?void 0:n.slice(0,3))==null?void 0:A.map(b=>e.jsx("span",{className:"inline-block px-2 py-0.5 bg-muted text-xs rounded",children:b},b)),(((E=s.tags)==null?void 0:E.length)||0)>3&&e.jsxs("span",{className:"inline-block px-2 py-0.5 text-xs text-muted-foreground",children:["+",(((z=s.tags)==null?void 0:z.length)||0)-3]})]})]})]},s.id)})})]})]})]})}export{ye as default};
