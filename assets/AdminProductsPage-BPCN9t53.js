import{r as n,b as G,j as e,B as r,L as p,X as J,l as g}from"./index-D3NDjr5B.js";import{A as K}from"./AdminHeader-BAyozb3y.js";import{I as W}from"./input-BdVIbqQ3.js";import{C as v,d as C}from"./card-BFk44DtX.js";import{B as L}from"./badge-BNXinaOz.js";import{C as D}from"./checkbox-v75AHoIs.js";import{D as Y,a as Z,b as _,c as b,f as ee}from"./dropdown-menu-DdC2iEtp.js";import{p as se}from"./products.api-Q-JVvUOW.js";import{a as j}from"./admin.api-JLzlyybJ.js";import{S as te}from"./SEO-BaS7uEy3.js";import{P as F}from"./plus-CiqXQg95.js";import{S as ae}from"./search-B-Nupm7w.js";import{E as N}from"./eye-DnRMw2Xi.js";import{E as P,S as B}from"./square-pen-CNJ5w3Zp.js";import{T as I}from"./trash-2-C4pTXx8A.js";import{E as ie}from"./ellipsis-vertical-BTA3OLDq.js";import"./house-DV4jgYEM.js";import"./index-C8hAjUGN.js";function Ce(){const[o,h]=n.useState([]),[S,k]=n.useState(!0),[d,M]=n.useState(""),[i,m]=n.useState(new Set),[x,f]=n.useState(!1),{toast:l}=G(),[u,$]=n.useState(1),[T,le]=n.useState(12),[w,U]=n.useState({totalPages:1,totalCount:0});n.useEffect(()=>{V()},[u,d]);const V=async()=>{try{k(!0);const s=await se.getAllProducts({page:u,limit:T,search:d});h(s.data),U(s==null?void 0:s.pagination)}catch{l({title:"Error",description:"Failed to load products",variant:"destructive"})}finally{k(!1)}},q=async(s,t)=>{if(confirm(`Are you sure you want to delete "${t}"?`))try{await j.deleteProduct(s),h(o.filter(a=>a.id!==s)),l({title:"Success",description:"Product deleted successfully"})}catch{l({title:"Error",description:"Failed to delete product",variant:"destructive"})}},H=async(s,t)=>{try{const a=await j.publishProduct(s,!t);h(o.map(y=>y.id===s?{...y,isPublished:a.isPublished}:y)),l({title:"Success",description:`Product ${t?"unpublished":"published"}`})}catch{l({title:"Error",description:"Failed to update product status",variant:"destructive"})}},A=()=>{i.size===c.length?m(new Set):m(new Set(c.map(s=>s.id)))},O=s=>{const t=new Set(i);t.has(s)?t.delete(s):t.add(s),m(t)},Q=async()=>{const s=i.size;if(confirm(`Are you sure you want to delete ${s} selected product${s>1?"s":""}?`))try{f(!0);const t=await j.bulkDelete(Array.from(i));h(o.filter(a=>!t.success.includes(a.id))),m(new Set),t.failedCount>0?l({title:"Partial Success",description:`${t.successCount} deleted, ${t.failedCount} failed`,variant:"default"}):l({title:"Success",description:`${s} product${s>1?"s":""} deleted successfully`})}catch{l({title:"Error",description:"Failed to delete products",variant:"destructive"})}finally{f(!1)}},R=async()=>{const s=i.size;try{f(!0);const t=await j.bulkPublish(Array.from(i),!0);h(o.map(a=>t.success.includes(a.id)?{...a,isPublished:!0}:a)),m(new Set),t.failedCount>0?l({title:"Partial Success",description:`${t.successCount} published, ${t.failedCount} failed`,variant:"default"}):l({title:"Success",description:`${s} product${s>1?"s":""} published successfully`})}catch{l({title:"Error",description:"Failed to publish products",variant:"destructive"})}finally{f(!1)}},X=async()=>{const s=i.size;try{f(!0);const t=await j.bulkPublish(Array.from(i),!1);h(o.map(a=>t.success.includes(a.id)?{...a,isPublished:!1}:a)),m(new Set),t.failedCount>0?l({title:"Partial Success",description:`${t.successCount} unpublished, ${t.failedCount} failed`,variant:"default"}):l({title:"Success",description:`${s} product${s>1?"s":""} unpublished successfully`})}catch{l({title:"Error",description:"Failed to unpublish products",variant:"destructive"})}finally{f(!1)}},c=o.filter(s=>{var t,a;return s.name.toLowerCase().includes(d.toLowerCase())||((t=s.brand)==null?void 0:t.toLowerCase().includes(d.toLowerCase()))||((a=s.category)==null?void 0:a.toLowerCase().includes(d.toLowerCase()))}),E=c.length>0&&i.size===c.length,z=i.size>0&&i.size<c.length;return e.jsxs(e.Fragment,{children:[e.jsx(te,{title:"Manage Products - Admin",description:"Manage product catalog"}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(K,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-serif text-3xl font-bold mb-2",children:"Products"}),e.jsxs("p",{className:"text-muted-foreground",children:[c.length," of ",o.length," products"]})]}),e.jsx(r,{asChild:!0,children:e.jsxs(p,{to:"/admin/products/new",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Add Product"]})})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(W,{placeholder:"Search products by name, brand, or category...",value:d,onChange:s=>M(s.target.value),className:"pl-10"})]}),i.size>0&&e.jsx(v,{className:"mb-6 border-primary/50 bg-primary/5",children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(L,{variant:"secondary",className:"text-sm font-medium",children:[i.size," selected"]}),e.jsxs(r,{variant:"ghost",size:"sm",onClick:()=>m(new Set),className:"h-8",children:[e.jsx(J,{className:"w-4 h-4 mr-1"}),"Clear"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:R,disabled:x,className:"h-8",children:[x?e.jsx(g,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(N,{className:"w-4 h-4 mr-1"}),"Publish All"]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:X,disabled:x,className:"h-8",children:[x?e.jsx(g,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(P,{className:"w-4 h-4 mr-1"}),"Unpublish All"]}),e.jsxs(r,{variant:"destructive",size:"sm",onClick:Q,disabled:x,className:"h-8",children:[x?e.jsx(g,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(I,{className:"w-4 h-4 mr-1"}),"Delete All"]})]})]})})}),!S&&c.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(D,{checked:E,onCheckedChange:A,className:z?"data-[state=checked]:bg-primary/50":""}),e.jsxs("label",{className:"text-sm font-medium cursor-pointer select-none",onClick:A,children:[E?"Deselect all":"Select all",z&&` (${i.size} selected)`]})]}),S?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(g,{className:"w-8 h-8 animate-spin text-primary"})}):c.length===0?e.jsx(v,{children:e.jsxs(C,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:d?"No products found matching your search":"No products yet"}),!d&&e.jsx(r,{asChild:!0,children:e.jsxs(p,{to:"/admin/products/new",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Create First Product"]})})]})}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:c.map(s=>{var t;return e.jsxs(v,{className:"overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx(D,{checked:i.has(s.id),onCheckedChange:()=>O(s.id),className:"bg-background border-2 shadow-sm"})}),e.jsxs("div",{className:"aspect-square bg-muted relative group",children:[e.jsx("img",{src:s.imageUrl,alt:s.name,className:"w-full h-full object-cover",onError:a=>{a.currentTarget.src="https://images.unsplash.com/photo-1441986300917-64674bd600d8"}}),e.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[e.jsx(r,{size:"sm",variant:"secondary",asChild:!0,children:e.jsxs(p,{to:`/admin/products/edit/${s.id}`,children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),"Edit"]})}),e.jsx(r,{size:"sm",variant:"secondary",asChild:!0,children:e.jsxs(p,{to:`/products/${s.slug}`,children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"View"]})})]})]}),e.jsxs(C,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium truncate",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.brand})]}),e.jsxs(Y,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(r,{variant:"ghost",size:"icon",className:"shrink-0",children:e.jsx(ie,{className:"w-4 h-4"})})}),e.jsxs(_,{align:"end",children:[e.jsx(b,{asChild:!0,children:e.jsxs(p,{to:`/admin/products/edit/${s.id}`,children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Edit"]})}),e.jsx(b,{asChild:!0,children:e.jsxs(p,{to:`/products/${s.slug}`,children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"View on Site"]})}),e.jsx(b,{onClick:()=>H(s.id,!!s.isPublished),children:s.isPublished?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Unpublish"]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Publish"]})}),e.jsx(ee,{}),e.jsxs(b,{onClick:()=>q(s.id,s.name),className:"text-destructive",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"font-semibold",children:["$",((t=s.price)==null?void 0:t.toFixed(2))||"â€”"]}),s.isFeatured&&e.jsx(L,{variant:"secondary",className:"text-xs",children:"Featured"}),s.isPublished===!1&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-yellow-100 text-yellow-800 rounded-lg mb-4 text-sm font-medium w-fit",children:[e.jsx(P,{className:"h-4 w-4"}),"UNPUBLISHED"]})]}),s.category&&e.jsx("p",{className:"text-xs text-muted-foreground mt-2 capitalize",children:s.category})]})]},s.id)})}),w.totalPages>1&&e.jsxs("div",{className:"flex justify-center items-center gap-4 mt-8",children:[e.jsx(r,{variant:"outline",disabled:u===1,onClick:()=>$(u-1),children:"Previous"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",u," of ",w.totalPages]}),e.jsx(r,{variant:"outline",disabled:u===w.totalPages,onClick:()=>$(u+1),children:"Next"})]})]})]})]})}export{Ce as default};
