import{r as x,d as H,j as e,B as c,L as f,X as O,l as j}from"./index-Qx7ctAR2.js";import{A as Q}from"./AdminHeader-DYmD83XB.js";import{I as R}from"./input-CnM6X11f.js";import{C as N,d as y}from"./card-BxAvFPHz.js";import{B as A}from"./badge-DoxW1_sb.js";import{C as E}from"./checkbox-BxBWjvHw.js";import{D as X,a as G,b as J,c as g,f as K}from"./dropdown-menu-CEi7-3xO.js";import{p as W}from"./products.api-DatHf7P2.js";import{a as p}from"./admin.api-Dn6gOgp3.js";import{S as Y}from"./SEO--jquLTE9.js";import{P as z}from"./plus-Dwbm8nTw.js";import{S as Z}from"./search-CgVacnWW.js";import{E as b}from"./eye-dAMp8hSy.js";import{E as v,S as D}from"./square-pen-CDWvvagD.js";import{T as F}from"./trash-2-D5pyjkbb.js";import{E as _}from"./ellipsis-vertical-BJVR5dXm.js";import"./house-CG1wo_RG.js";import"./index-Cv7ubkdg.js";function ge(){const[n,o]=x.useState([]),[C,S]=x.useState(!0),[m,L]=x.useState(""),[i,d]=x.useState(new Set),[u,h]=x.useState(!1),{toast:r}=H();x.useEffect(()=>{B()},[]);const B=async()=>{try{S(!0);const s=await W.getAllProducts({limit:1e3});o(s.data)}catch{r({title:"Error",description:"Failed to load products",variant:"destructive"})}finally{S(!1)}},I=async(s,t)=>{if(confirm(`Are you sure you want to delete "${t}"?`))try{await p.deleteProduct(s),o(n.filter(a=>a.id!==s)),r({title:"Success",description:"Product deleted successfully"})}catch{r({title:"Error",description:"Failed to delete product",variant:"destructive"})}},M=async(s,t)=>{try{const a=await p.publishProduct(s,!t);o(n.map(w=>w.id===s?{...w,isPublished:a.isPublished}:w)),r({title:"Success",description:`Product ${t?"unpublished":"published"}`})}catch{r({title:"Error",description:"Failed to update product status",variant:"destructive"})}},P=()=>{i.size===l.length?d(new Set):d(new Set(l.map(s=>s.id)))},T=s=>{const t=new Set(i);t.has(s)?t.delete(s):t.add(s),d(t)},U=async()=>{const s=i.size;if(confirm(`Are you sure you want to delete ${s} selected product${s>1?"s":""}?`))try{h(!0);const t=await p.bulkDelete(Array.from(i));o(n.filter(a=>!t.success.includes(a.id))),d(new Set),t.failedCount>0?r({title:"Partial Success",description:`${t.successCount} deleted, ${t.failedCount} failed`,variant:"default"}):r({title:"Success",description:`${s} product${s>1?"s":""} deleted successfully`})}catch{r({title:"Error",description:"Failed to delete products",variant:"destructive"})}finally{h(!1)}},V=async()=>{const s=i.size;try{h(!0);const t=await p.bulkPublish(Array.from(i),!0);o(n.map(a=>t.success.includes(a.id)?{...a,isPublished:!0}:a)),d(new Set),t.failedCount>0?r({title:"Partial Success",description:`${t.successCount} published, ${t.failedCount} failed`,variant:"default"}):r({title:"Success",description:`${s} product${s>1?"s":""} published successfully`})}catch{r({title:"Error",description:"Failed to publish products",variant:"destructive"})}finally{h(!1)}},q=async()=>{const s=i.size;try{h(!0);const t=await p.bulkPublish(Array.from(i),!1);o(n.map(a=>t.success.includes(a.id)?{...a,isPublished:!1}:a)),d(new Set),t.failedCount>0?r({title:"Partial Success",description:`${t.successCount} unpublished, ${t.failedCount} failed`,variant:"default"}):r({title:"Success",description:`${s} product${s>1?"s":""} unpublished successfully`})}catch{r({title:"Error",description:"Failed to unpublish products",variant:"destructive"})}finally{h(!1)}},l=n.filter(s=>{var t,a;return s.name.toLowerCase().includes(m.toLowerCase())||((t=s.brand)==null?void 0:t.toLowerCase().includes(m.toLowerCase()))||((a=s.category)==null?void 0:a.toLowerCase().includes(m.toLowerCase()))}),k=l.length>0&&i.size===l.length,$=i.size>0&&i.size<l.length;return e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:"Manage Products - Admin",description:"Manage product catalog"}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Q,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-serif text-3xl font-bold mb-2",children:"Products"}),e.jsxs("p",{className:"text-muted-foreground",children:[l.length," of ",n.length," products"]})]}),e.jsx(c,{asChild:!0,children:e.jsxs(f,{to:"/admin/products/new",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Add Product"]})})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(R,{placeholder:"Search products by name, brand, or category...",value:m,onChange:s=>L(s.target.value),className:"pl-10"})]}),i.size>0&&e.jsx(N,{className:"mb-6 border-primary/50 bg-primary/5",children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(A,{variant:"secondary",className:"text-sm font-medium",children:[i.size," selected"]}),e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>d(new Set),className:"h-8",children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),"Clear"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:V,disabled:u,className:"h-8",children:[u?e.jsx(j,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(b,{className:"w-4 h-4 mr-1"}),"Publish All"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:q,disabled:u,className:"h-8",children:[u?e.jsx(j,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(v,{className:"w-4 h-4 mr-1"}),"Unpublish All"]}),e.jsxs(c,{variant:"destructive",size:"sm",onClick:U,disabled:u,className:"h-8",children:[u?e.jsx(j,{className:"w-4 h-4 mr-1 animate-spin"}):e.jsx(F,{className:"w-4 h-4 mr-1"}),"Delete All"]})]})]})})}),!C&&l.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(E,{checked:k,onCheckedChange:P,className:$?"data-[state=checked]:bg-primary/50":""}),e.jsxs("label",{className:"text-sm font-medium cursor-pointer select-none",onClick:P,children:[k?"Deselect all":"Select all",$&&` (${i.size} selected)`]})]}),C?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(j,{className:"w-8 h-8 animate-spin text-primary"})}):l.length===0?e.jsx(N,{children:e.jsxs(y,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:m?"No products found matching your search":"No products yet"}),!m&&e.jsx(c,{asChild:!0,children:e.jsxs(f,{to:"/admin/products/new",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Create First Product"]})})]})}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:l.map(s=>{var t;return e.jsxs(N,{className:"overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx(E,{checked:i.has(s.id),onCheckedChange:()=>T(s.id),className:"bg-background border-2 shadow-sm"})}),e.jsxs("div",{className:"aspect-square bg-muted relative group",children:[e.jsx("img",{src:s.imageUrl,alt:s.name,className:"w-full h-full object-cover",onError:a=>{a.currentTarget.src="https://images.unsplash.com/photo-1441986300917-64674bd600d8"}}),e.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[e.jsx(c,{size:"sm",variant:"secondary",asChild:!0,children:e.jsxs(f,{to:`/admin/products/edit/${s.id}`,children:[e.jsx(D,{className:"w-4 h-4 mr-1"}),"Edit"]})}),e.jsx(c,{size:"sm",variant:"secondary",asChild:!0,children:e.jsxs(f,{to:`/products/${s.slug}`,children:[e.jsx(b,{className:"w-4 h-4 mr-1"}),"View"]})})]})]}),e.jsxs(y,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium truncate",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.brand})]}),e.jsxs(X,{children:[e.jsx(G,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",className:"shrink-0",children:e.jsx(_,{className:"w-4 h-4"})})}),e.jsxs(J,{align:"end",children:[e.jsx(g,{asChild:!0,children:e.jsxs(f,{to:`/admin/products/edit/${s.id}`,children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Edit"]})}),e.jsx(g,{asChild:!0,children:e.jsxs(f,{to:`/products/${s.slug}`,children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"View on Site"]})}),e.jsx(g,{onClick:()=>M(s.id,!!s.isPublished),children:s.isPublished?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Unpublish"]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Publish"]})}),e.jsx(K,{}),e.jsxs(g,{onClick:()=>I(s.id,s.name),className:"text-destructive",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"font-semibold",children:["$",((t=s.price)==null?void 0:t.toFixed(2))||"â€”"]}),s.isFeatured&&e.jsx(A,{variant:"secondary",className:"text-xs",children:"Featured"}),s.isPublished===!1&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-yellow-100 text-yellow-800 rounded-lg mb-4 text-sm font-medium w-fit",children:[e.jsx(v,{className:"h-4 w-4"}),"UNPUBLISHED"]})]}),s.category&&e.jsx("p",{className:"text-xs text-muted-foreground mt-2 capitalize",children:s.category})]})]},s.id)})})]})]})]})}export{ge as default};
