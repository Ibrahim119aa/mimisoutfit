import{c as A,r,j as e,d as W,B as R}from"./index-fZ_4v1pA.js";import{j as V}from"./index-C24RUjyj.js";import{D as F,a as H,b as G,c as M}from"./dropdown-menu-Mh0D0jpL.js";import{M as K}from"./message-circle-hOTgRet_.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]],Z=A("image-off",Y);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],Q=A("link-2",J);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],E=A("share-2",X);function ee(s){return!s||typeof s!="string"||s.length<6?!1:/^[0-9A-Za-z#$%*+,\-.:;=?@[\]^_{|}~]+$/.test(s)}function te(s){return{"1/1":{width:32,height:32},"3/4":{width:32,height:42},"4/5":{width:32,height:40},"16/9":{width:32,height:18},"21/9":{width:32,height:14}}[s||"1/1"]||{width:32,height:32}}function ce({src:s,alt:u,blurhash:l,className:v="",aspectRatio:d,priority:p=!1,sizes:S,onLoad:x,onError:y,placeholder:f="blurhash",objectFit:i="cover"}){const w="https://images.unsplash.com/photo-1441986300917-64674bd600d8",[h,g]=r.useState(!1),[j,k]=r.useState(p),[N,$]=r.useState(!1),[t,o]=r.useState(s),[m,b]=r.useState(!1),[D,T]=r.useState(""),_=r.useRef(null),I=r.useRef(null),q=(f==="blurhash"&&!l?"blur":f)==="blurhash"&&l&&ee(l);r.useEffect(()=>{if(!(!q||!I.current||!l))try{const a=I.current,n=a.getContext("2d");if(!n)return;const{width:c,height:C}=te(d);a.width=c,a.height=C;const O=V(l,c,C),B=n.createImageData(c,C);B.data.set(O),n.putImageData(B,0,0),T(a.toDataURL())}catch(a){console.warn("[OptimizedImage] Blurhash decode failed, using simple blur fallback:",a)}},[q,l,d]),r.useEffect(()=>{if(p||!_.current)return;const a=new IntersectionObserver(n=>{n.forEach(c=>{c.isIntersecting&&(k(!0),a.disconnect())})},{rootMargin:"50px",threshold:.01});return a.observe(_.current),()=>{a.disconnect()}},[p]),r.useEffect(()=>{o(s),$(!1),b(!1),g(!1),console.log("This is image url"),console.log(s)},[s]);const z=()=>{g(!0),x==null||x()},L=()=>{if(!m&&t===s&&s!==w){b(!0),o(w),g(!1);return}$(!0),g(!0),y==null||y()},P=(a=>{if(a){if(a.includes("unsplash.com")){const n=a.includes("?")?"&":"?";return`
        ${a}${n}w=400 400w,
        ${a}${n}w=800 800w,
        ${a}${n}w=1200 1200w,
        ${a}${n}w=1600 1600w
      `.trim()}if(a.includes("cloudinary.com")){const n=a.split("/upload/")[0]+"/upload/",c=a.split("/upload/")[1];return`
        ${n}w_400,f_auto,q_auto/${c} 400w,
        ${n}w_800,f_auto,q_auto/${c} 800w,
        ${n}w_1200,f_auto,q_auto/${c} 1200w,
        ${n}w_1600,f_auto,q_auto/${c} 1600w
      `.trim()}}})(t),U=d?{"1/1":"aspect-square","3/4":"aspect-[3/4]","4/5":"aspect-[4/5]","16/9":"aspect-[16/9]","21/9":"aspect-[21/9]"}[d]||`aspect-[${d}]`:"";return e.jsxs("div",{ref:_,className:`relative overflow-hidden bg-muted ${U} ${v}`,children:[e.jsx("canvas",{ref:I,className:"hidden","aria-hidden":"true"}),!t||N?e.jsx("div",{className:"image-placeholder w-full h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Z,{className:"h-12 w-12 text-muted-foreground/40 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-muted-foreground/60",children:"Image unavailable"})]})}):e.jsxs(e.Fragment,{children:[!h&&f==="blurhash"&&D&&e.jsx("img",{src:D,alt:"","aria-hidden":"true",className:"absolute inset-0 w-full h-full object-cover scale-110 blur-xl"}),!h&&f==="blur"&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-muted via-muted/80 to-muted animate-pulse"}),j&&t&&e.jsx("img",{src:t,alt:u,srcSet:P,sizes:S||"(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw",className:`
                relative z-10 w-full h-full transition-all duration-700
                ${i==="cover"?"object-cover":""}
                ${i==="contain"?"object-contain":""}
                ${i==="fill"?"object-fill":""}
                ${h?"opacity-100 scale-100":"opacity-0 scale-105"}
              `,loading:p?"eager":"lazy",decoding:"async",onLoad:z,onError:L}),!h&&j&&f==="blur"&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-20",children:e.jsx("div",{className:"w-8 h-8 border-2 border-accent/30 border-t-accent rounded-full animate-spin"})})]})]})}function le({title:s,description:u,price:l,imageUrl:v,url:d,type:p,variant:S="outline",size:x="default",showLabel:y=!0,className:f=""}){const{toast:i}=W(),[w,h]=r.useState(!1),g=()=>{let t=`*${s}*

`;return u&&(t+=`${u}

`),l&&(t+=`ðŸ’° *Price:* ${l}

`),t+=`ðŸ”— View here: ${d}`,t},j=async()=>{h(!0);const t=g();try{const o=encodeURIComponent(t);/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?window.location.href=`whatsapp://send?text=${o}`:window.open(`https://web.whatsapp.com/send?text=${o}`,"_blank"),i({title:"Opening WhatsApp...",description:"Share with styled formatting"})}catch(o){console.error("Share failed:",o);const m=encodeURIComponent(t);window.open(`https://wa.me/?text=${m}`,"_blank"),i({title:"Opening WhatsApp...",description:"Sharing as text with link",variant:"default"})}finally{h(!1)}},k=async()=>{h(!0);try{if(!navigator.share)throw new Error("Web Share API not supported");const t={title:s,text:u||s,url:d};if(v)try{const m=await(await fetch(v)).blob(),b=new File([m],`${p}-${Date.now()}.jpg`,{type:m.type});navigator.canShare({files:[b]})&&(t.files=[b])}catch(o){console.error("Failed to fetch image for sharing:",o)}await navigator.share(t),i({title:"Shared successfully!",description:"Your content has been shared"})}catch(t){t.name!=="AbortError"&&(console.error("Share failed:",t),i({title:"Share failed",description:"Unable to share at this time",variant:"destructive"}))}finally{h(!1)}},N=async()=>{try{await navigator.clipboard.writeText(d),i({title:"Link copied!",description:"The link has been copied to your clipboard"})}catch(t){console.error("Copy failed:",t),i({title:"Copy failed",description:"Unable to copy link",variant:"destructive"})}},$=typeof navigator<"u"&&!!navigator.share;return e.jsxs(F,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(R,{variant:S,size:x,disabled:w,className:f,children:[e.jsx(E,{className:"h-4 w-4"}),y&&x!=="icon"&&e.jsx("span",{className:"ml-2",children:"Share"})]})}),e.jsxs(G,{align:"end",className:"w-48",children:[$&&e.jsxs(M,{onClick:k,disabled:w,className:"cursor-pointer",children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Share..."})]}),e.jsxs(M,{onClick:j,disabled:w,className:"cursor-pointer",children:[e.jsx(K,{className:"mr-2 h-4 w-4 text-green-600"}),e.jsx("span",{children:"Share to WhatsApp"})]}),e.jsxs(M,{onClick:N,className:"cursor-pointer",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Copy Link"})]})]})]})}export{ce as O,le as S};
